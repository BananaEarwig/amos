*Entry	D3 Address
*	D1 Length
*	D0 0 Squash  1 Unsquash


Squasher:
	tst.l	d0
	bne	UnSquash
********************************************************************
*
* Squash code from STOS!
*
*
********************************************************************
Squash:
	MOVE.L	D3,D0
	ADD.L	D0,D1
	MOVEM.L	D0-6/A0-7,-(A7)
	LEA	L224280(PC),A0
	MOVE.L	D0,(A0)
	MOVE.L	D0,4(A0)
	MOVE.L	D1,8(A0)
	BRA	L2242A0


	
l224234	DC.B	0,0,0,0
l224238	DC.B	0,0
l22423a	DC.B	1,0
l22423c	DC.B	2,0,4,0
l224240	DC.B	$10,0,0,8
l224244	DC.B	0,9,0,$A
l224248	DC.B	0,$C,0,0
l22424c	DC.B	0,0,0,0
l224250	DC.B	0,8,0,2
l224254	DC.B	0,3,0,3
l224258	DC.B	0,3,0,1
l22425c	DC.B	0,4,0,5
l224260	DC.B	0,6
l224262	DC.B	0,0
l224264	DC.B	0,0,0,0
l224268	DC.B	0,0
l22426a	DC.B	0,0
l22426c	DC.B	0,0,0,0
l224270	DC.B	0,0,0,0
l224274	DC.B	$4D,$B8,$FF,$FF
l224278	DC.B	0,0,0,0
l22427c	DC.B	0,0,0,0
l224280	DC.B	0,2,3,$4A
l224284	DC.B	0,2,3,$4A
l224288	DC.B	0,3,$9A,$41
l22428c	DC.B	0,7,0,0
l224290	DC.B	0,0,0,0
l224294	DC.B	0,0,0,0
l224298	DC.B	0,0
l22429a	DC.B	0,0
l22429c	DC.B	$10,$24,1,0

L2242A0	MOVEA.L	L224280(PC),A0
	MOVEA.L	L224288(PC),A1
	MOVEA.L	L224284(PC),A2
	MOVEQ	#1,D2
	CLR.W	D1
	CLR.L	D7
L2242B2	BSR	L224304
	TST.B	D0
	BEQ.S	L2242C6
	ADDQ.W	#1,D1
	CMPI.W	#$108,D1
	BNE.S	L2242C6
	BSR	L2243D8
L2242C6	CMPA.L	A0,A1
	BGT.S	L2242B2
	BSR	L2243D8
	BSR	L224420
	MOVE.L	D7,(A2)+
	MOVEA.L	L224280(PC),A0
	MOVEA.L	L224288(PC),A1
	MOVE.L	A1,D2
	SUB.L	A0,D2
	MOVE.L	D2,(A2)+
	CLR.L	D0
	CLR.L	D1
	CLR.L	D2
	CLR.L	D3
	CLR.L	D4
	CLR.L	D5
	LEA	L224262(PC),A3
	MOVEM.W	(A3)+,D0-5
	MOVEA.L	A2,A3
	SUBA.L	A0,A3
	LEA	L224288(PC),A4
	SUBA.L	A2,A4
	BRA	L22442E

L224304	MOVEA.L	A0,A3
	ADDA.L	L22429A(PC),A3
	CMPA.L	A1,A3
	BLE.S	L224310
	MOVEA.L	A1,A3
L224310	MOVEQ	#1,D5
	MOVEA.L	A0,A5
	ADDQ.W	#1,A5
L224316	MOVE.B	(A0),D3
	MOVE.B	1(A0),D4
L22431C	CMP.B	(A5)+,D3
	BNE.S	L224324
	CMP.B	(A5),D4
	BEQ.S	L22432C
L224324	CMPA.L	A5,A3
	BGT.S	L22431C
	BRA	L22438A
L22432C	SUBQ.W	#1,A5
	MOVEA.L	A0,A4
L224330	MOVE.B	(A4)+,D3
	CMP.B	(A5)+,D3
	BNE.S	L22433A
	CMPA.L	A5,A3
	BGT.S	L224330
L22433A	MOVE.L	A4,D3
	SUB.L	A0,D3
	SUBQ.L	#1,D3
	CMP.L	D3,D5
	BGE.S	L224386
	MOVE.L	A5,D4
	SUB.L	A0,D4
	SUB.L	D3,D4
	SUBQ.W	#1,D4
	CMP.L	#4,D3
	BLE.S	L224364
	MOVEQ	#6,D6
	CMP.L	#$101,D3
	BLT.S	L224362
	MOVE.W	#$100,D3
L224362	BRA.S	L22436A
L224364	MOVE.W	D3,D6
	SUBQ.W	#2,D6
	LSL.W	#1,D6
L22436A	LEA	L22423A(PC),A6
	CMP.W	0(A6,D6.W),D4
	BGE.S	L224386
	MOVE.L	D3,D5
	MOVE.L	A0,-(A7)
	LEA	L224234(PC),A0
	MOVE.L	D4,(A0)
	LEA	L224238(PC),A0
	MOVE.B	D6,(A0)
	MOVEA.L	(A7)+,A0
L224386	CMPA.L	A5,A3
	BGT.S	L224316
L22438A	CMP.L	#1,D5
	BEQ.S	L2243CC
	BSR	L2243D8
	MOVE.B	L224238(PC),D6
	MOVE.L	L224234(PC),D3
	MOVE.W	8(A6,D6.W),D0
	BSR	L224412
	MOVE.W	$10(A6,D6.W),D0
	BEQ.S	L2243B4
	MOVE.L	D5,D3
	SUBQ.W	#1,D3
	BSR	L224412
L2243B4	MOVE.W	$18(A6,D6.W),D0
	MOVE.W	$20(A6,D6.W),D3
	BSR	L224412
	ADDI.W	#1,$28(A6,D6.W)
	ADDA.L	D5,A0
	CLR.B	D0
	RTS

L2243CC	MOVE.B	(A0)+,D3
	MOVEQ	#8,D0
	BSR	L224412
	MOVEQ	#1,D0
	RTS

L2243D8	TST.W	D1
	BEQ.S	L2243F8
	MOVE.W	D1,D3
	CLR.W	D1
	CMP.W	#9,D3
	BGE.S	L2243FA
	MOVE.L	A0,-(A7)
	LEA	L22426A(PC),A0
	ADDQ.W	#1,(A0)
	MOVEA.L	(A7)+,A0
	SUBQ.W	#1,D3
	MOVEQ	#5,D0
	BRA	L224412
L2243F8	RTS

L2243FA	MOVE.L	A0,-(A7)
	LEA	L22426C(PC),A0
	ADDQ.W	#1,(A0)
	MOVEA.L	(A7)+,A0
	SUBI.W	#9,D3
	ORI.W	#$700,D3
	MOVEQ	#$B,D0
	BRA	L224412
L224412	SUBQ.W	#1,D0
L224414	LSR.L	#1,D3
	ROXL.L	#1,D2
	BCS.S	L224422
	DBF	D0,L224414
	RTS

L224420	CLR.W	D0
L224422	MOVE.L	D2,(A2)+
	EOR.L	D2,D7
	MOVEQ	#1,D2
	DBF	D0,L224414
	RTS

L22442E	MOVE.L	A3,D7
	MOVEM.L	(A7)+,D0-6/A0-7
	MOVE.L	D7,D3
	CLR.B	D2
	RTS
**********************************
UnSquash:
	MOVE.L	D3,D0
	ADD.L	D0,D1
	MOVEA.L	D1,A0
	MOVEA.L	D0,A1
	MOVEA.L	-(A0),A2
	ADDA.L	A1,A2
	MOVE.L	-(A0),D5
	MOVE.L	-(A0),D0
	EOR.L	D0,D5
L22446E	LSR.L	#1,D0
	BNE.S	L224476
	BSR	L2244E8
L224476	BCS.S	L2244AE
	MOVEQ	#8,D1
	MOVEQ	#1,D3
	LSR.L	#1,D0
	BNE.S	L224484
	BSR	L2244E8
L224484	BCS.S	L2244D4
	MOVEQ	#3,D1
	CLR.W	D4
L22448A	BSR	L2244F4
	MOVE.W	D2,D3
	ADD.W	D4,D3
L224492	MOVEQ	#7,D1
L224494	LSR.L	#1,D0
	BNE.S	L22449A
	BSR.S	L2244E8
L22449A	ROXL.L	#1,D2
	DBF	D1,L224494
	MOVE.B	D2,-(A2)
	DBF	D3,L224492
	BRA.S	L2244E0
L2244A8	MOVEQ	#8,D1
	MOVEQ	#8,D4
	BRA.S	L22448A
L2244AE	MOVEQ	#2,D1
	BSR.S	L2244F4
	CMP.B	#2,D2
	BLT.S	L2244CA
	CMP.B	#3,D2
	BEQ.S	L2244A8
	MOVEQ	#8,D1
	BSR.S	L2244F4
	MOVE.W	D2,D3
	MOVE.W	#$C,D1
	BRA.S	L2244D4
L2244CA	MOVE.W	#9,D1
	ADD.W	D2,D1
	ADDQ.W	#2,D2
	MOVE.W	D2,D3
L2244D4	BSR.S	L2244F4
L2244D6	SUBQ.W	#1,A2
	MOVE.B	0(A2,D2.W),(A2)
	DBF	D3,L2244D6
L2244E0	CMPA.L	A2,A1
	BLT.S	L22446E
	RTS

L2244E8	MOVE.L	-(A0),D0
	EOR.L	D0,D5
	MOVE.B	#$10,CCR
	ROXR.L	#1,D0
	RTS

L2244F4	SUBQ.W	#1,D1
	CLR.W	D2
L2244F8	LSR.L	#1,D0
	BNE.S	L224506
	MOVE.L	-(A0),D0
	EOR.L	D0,D5
	MOVE.B	#$10,CCR
	ROXR.L	#1,D0
L224506	ROXL.L	#1,D2
	DBF	D1,L2244F8
	RTS


